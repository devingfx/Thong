if(window&&document){(function(window,document){function ActiveTmpl(e){e=e||document.createElement("script");return e}function activateTmpls(e){var t=(e||document).getElementsByTagName("script");for(var n=0,r;r=t[n++];){console.log(r.type);if(tmpl.rules.hasOwnProperty(r.type)&&r.innerHTML!=""){console.log("azzz"+typeof r.extendWith);r.extendWith(ActiveTmpl).initialize()}}}Object.defineProperty(Object.prototype,"extendWith",{enumerable:false,value:function(e){if(typeof e=="function"){for(var t in e.prototype)this[t]=e.prototype[t];e.call(this)}else if(typeof e=="object")for(var t in e)this[t]=e[t]}});ActiveTmpl.prototype={initialize:function(){console.log("ActiveTmpl("+script+" ID:"+script.id+");");script._rendered=[];script.render=tmpl(script.innerHTML,script.type);if(script.id!="")window[script.id]=script.render;var _dataProvider;Object.defineProperty(this,"dataProvider",{set:function(e){_dataProvider=e;script.repeat(e)},get:function(){return _dataProvider}});var _superSetAtt=script.setAttribute.bind(script);script.setAttribute=function(e,t){if(e=="data")script.data=t;_superSetAtt.apply(script,arguments)};Object.defineProperty(this,"data",{set:function(v){try{script.innerHTML=script.render.call(script,typeof v=="string"?eval(v):v)}catch(e){}}});if(script.getAttribute("data"))script.data=script.getAttribute("data")},_eventAttribute:function(name,data,i){var event=new Event(name);event.data=data;if(this.getAttribute(name)){var item=data[i];eval("(function(){"+this.getAttribute(name)+"})").call(script,event)}this.dispatchEvent&&this.dispatchEvent(event)},appendChild:function(e){var t=this._rendered.length>0?this._rendered[this._rendered.length-1]:this;this._rendered.push(e);if(t.nextSibling)this.parentNode.insertBefore(e,t.nextSibling);else this.parentNode.appendChild(e)},repeat:function(e){var t=document.createElement("div");this._eventAttribute("onBeforeRepeat",e);if(!(this.hasAttribute("appends")&&(this.getAttribute("appends")==""||this.getAttribute("appends")=="true"))){this._rendered.forEach(function(e){e.parentNode.removeChild(e)});this._rendered=[]}if(typeof e.length!="undefined"){for(var n=0,r;r=e[n];n++){t.innerHTML=this.render(e[n]);var i=Array.prototype.slice.call(t.childNodes);for(var s=0,o;o=i[s++];)this.appendChild(o);this._eventAttribute("onRepeat",e,n)}}else{for(var n in e){t.innerHTML=this.render(e[n]);for(var s=0,o;o=t.childNodes[s++];)this.appendChild(o);this._eventAttribute("onRepeat",e,n)}}this._eventAttribute("onRepeatEnd",e,n);return this}};window.addEventListener("DOMContentLoaded",function(){activateTmpls()})})(window,document)}